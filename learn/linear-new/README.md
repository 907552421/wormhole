a simpler implementation of linear
